<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Spend Trillions Simulator</title>
    <link rel="stylesheet" href="style.css" />
  </head>

  <body>
    <header>
      <h1>Spend Trillions Simulator</h1>
    </header>

    <div class="leftmoney">
      <h2>$1,000,000,000,000</h2>
    </div>

    <main class="items-container">
      <div class="card">
        <img src="Assets/big-mac.jpg" alt="Big Mac" />
        <h3>Big Mac</h3>
        <p class="price">$2</p>
        <div class="actions">
          <button class="sell">Sell</button>
          <input type="number" value="0" min="0" />
          <button class="buy">Buy</button>
        </div>
      </div>

      <div class="card">
        <img src="Assets/flip-flops.jpg" alt="Flip Flops" />
        <h3>Flip Flops</h3>
        <p class="price">$3</p>
        <div class="actions">
          <button class="sell">Sell</button>
          <input type="number" value="0" min="0" />
          <button class="buy">Buy</button>
        </div>
      </div>

      <div class="card">
        <img src="Assets/coca-cola-pack.jpg" alt="Coca Cola Pack" />
        <h3>Coca-Cola Pack</h3>
        <p class="price">$5</p>
        <div class="actions">
          <button class="sell">Sell</button>
          <input type="number" value="0" min="0" />
          <button class="buy">Buy</button>
        </div>
      </div>

      <div class="card">
        <img src="Assets/space_station.png" alt="Space Station" />
        <h3>Space Station</h3>
        <p class="price">$150,000,000,000</p>
        <div class="actions">
          <button class="sell">Sell</button>
          <input type="number" value="0" min="0" />
          <button class="buy">Buy</button>
        </div>
      </div>

      <div class="receipt">
        <h2>Your Receipt</h2>
        <div class="items-list"></div>
        <div class="total">TOTAL: $0</div>
      </div>
    </main>

    <script>
      let moneyLeft = 1000000000000;
      const moneyDisplay = document.querySelector(".leftmoney h2");
      const receiptItems = document.querySelector(".items-list");
      const receiptTotal = document.querySelector(".total");

      function formatMoney(amount) {
        return "$" + amount.toLocaleString();
      }

      function updateMoneyDisplay(oldAmount, newAmount) {
        const change = newAmount - oldAmount;
        const steps = 20;
        const stepTime = 20;

        let currentStep = 0;
        const timer = setInterval(() => {
          currentStep++;
          const currentAmount = oldAmount + (change * currentStep) / steps;
          moneyDisplay.textContent = formatMoney(Math.round(currentAmount));

          if (currentStep >= steps) {
            clearInterval(timer);
            moneyDisplay.textContent = formatMoney(newAmount);
          }
        }, stepTime);
      }

      function refreshReceipt() {
        receiptItems.innerHTML = "";
        let overallTotal = 0;

        document.querySelectorAll(".card").forEach((itemCard) => {
          const itemName = itemCard.querySelector("h3").textContent;
          const itemPriceText = itemCard
            .querySelector(".price")
            .textContent.replace(/[$,]/g, "");
          const itemPrice = parseFloat(itemPriceText);
          const itemQuantity =
            parseInt(itemCard.querySelector("input").value) || 0;

          if (itemQuantity > 0) {
            const itemTotal = itemPrice * itemQuantity;
            overallTotal += itemTotal;

            const receiptLine = document.createElement("div");
            receiptLine.textContent = `${itemName} x${itemQuantity} ${formatMoney(
              itemTotal
            )}`;
            receiptItems.appendChild(receiptLine);
          }
        });

        receiptTotal.textContent = `TOTAL: ${formatMoney(overallTotal)}`;
      }

      document.querySelectorAll(".card").forEach((itemCard) => {
        const itemPriceText = itemCard
          .querySelector(".price")
          .textContent.replace(/[$,]/g, "");
        const itemPrice = parseFloat(itemPriceText);
        const quantityInput = itemCard.querySelector("input");
        const buyButton = itemCard.querySelector(".buy");
        const sellButton = itemCard.querySelector(".sell");

        let currentQuantity = 0;
        quantityInput.value = currentQuantity;

        buyButton.addEventListener("click", () => {
          const canAfford = Math.floor(moneyLeft / itemPrice);
          if (canAfford <= 0) return;

          currentQuantity += 1;
          quantityInput.value = currentQuantity;
          const oldMoney = moneyLeft;
          moneyLeft -= itemPrice;
          updateMoneyDisplay(oldMoney, moneyLeft);
          refreshReceipt();
        });

        sellButton.addEventListener("click", () => {
          if (currentQuantity <= 0) return;

          currentQuantity -= 1;
          quantityInput.value = currentQuantity;
          const oldMoney = moneyLeft;
          moneyLeft += itemPrice;
          updateMoneyDisplay(oldMoney, moneyLeft);
          refreshReceipt();
        });
      });

      moneyDisplay.textContent = formatMoney(moneyLeft);
      refreshReceipt();
    </script>
  </body>
</html>
